<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    Developer Guide: Getting Started
  
</title>

<meta name="description" content="A visualization in SKQW is a JavaScript module in the commonjs format. Since SKQW is implemented on top of the Electron platform, which uses recent versions of Node and Chrome, you are free to use (mo">
<meta property="og:type" content="website">
<meta property="og:title" content="Developer Guide: Getting Started">
<meta property="og:url" content="http://localhost/developer-guide-getting-started/index.html">
<meta property="og:site_name" content="SKQW">
<meta property="og:description" content="A visualization in SKQW is a JavaScript module in the commonjs format. Since SKQW is implemented on top of the Electron platform, which uses recent versions of Node and Chrome, you are free to use (mo">
<meta property="og:updated_time" content="2016-08-20T05:40:43.339Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Developer Guide: Getting Started">
<meta name="twitter:description" content="A visualization in SKQW is a JavaScript module in the commonjs format. Since SKQW is implemented on top of the Electron platform, which uses recent versions of Node and Chrome, you are free to use (mo">


  <link rel="alternative" href="/atom.xml" title="SKQW" type="application/atom+xml">



  <link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="/styles/main.css">




</head>
<body
  
    class="monochrome"
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/">SKQW</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <a href="/">
      <img src="/images/logo-line.svg" class="sidebar-logo">
    </a>
    <div class="info">
      <div class="content">
        
      </div>
    </div>
  </div>
  <div class="body">
    
    
    <ul class="nav">
      
      

      
      <li class="section-title">
        <span>User Guide</span>
      </li>
      
      
      
      

      
      <li>
        <a href="/getting-started" title="Getting Started">Getting Started</a>
      </li>
      
      
      
    </ul>
    
    <ul class="nav">
      
      

      
      <li class="section-title">
        <span>Developer Guide</span>
      </li>
      
      
      
      

      
      <li>
        <a href="/developer-guide-getting-started" title="Getting Started">Getting Started</a>
      </li>
      
      
      
      

      
      <li>
        <a href="/api-reference" title="API Reference">API Reference</a>
      </li>
      
      
      
    </ul>
    
    <ul class="nav">
      
      

      
      <li>
        <a href="https://github.com/michaelbromley/skqw" title="Github" target="_blank" rel="external">Github</a>
      </li>
      
      
      
    </ul>
    
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 800px">
      
          <article id="page-undefined" class="article article-type-page">
  
    <h1 class="article-header">
      Developer Guide: Getting Started
    </h1>
  
  

  <div class="article-info">
    <span class="article-date">
  Updated: 2016-08-20
</span>

    

    

  </div>
  <div class="article-entry">
    <p>A visualization in SKQW is a JavaScript module in the commonjs format. Since SKQW is implemented on top of the Electron platform, which uses recent versions of Node and Chrome, you are free to use (most) ES2015 language features. One notable exception is that module imports and exports must be in the <a href="https://nodejs.org/docs/latest/api/modules.html" target="_blank" rel="external">Node commonjs</a> (<code>module.exports</code> and <code>require()</code>) format.</p>
<h2 id="File-Location-amp-Naming"><a href="#File-Location-amp-Naming" class="headerlink" title="File Location &amp; Naming"></a>File Location &amp; Naming</h2><p>A visualization main file must be located in a subdirectory of the “library path” (as set in the UI), and must be named “index.js”:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// &quot;visualizations&quot; is set as the library path in the app.</div><div class="line"></div><div class="line">- visualizations/</div><div class="line">    |</div><div class="line">    |- myVis/</div><div class="line">    |   |- index.js</div><div class="line">    |</div></pre></td></tr></table></figure>
<h2 id="Basic-Example"><a href="#Basic-Example" class="headerlink" title="Basic Example"></a>Basic Example</h2><p>Here is a bare-bones visualization:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// canvas context.</span></div><div class="line"><span class="keyword">let</span> ctx;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params">skqw</span>) </span>&#123;</div><div class="line">    ctx = skqw.createCanvas().getContext(<span class="string">'2d'</span>);</div><div class="line">    ctx.fillStyle = <span class="string">`hsla(0, 50%, 50%, 0.8)`</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tick</span>(<span class="params">skqw</span>) </span>&#123;</div><div class="line">    <span class="keyword">const</span> &#123; width, height &#125; = skqw.dimensions;</div><div class="line">    <span class="keyword">const</span> ft = skqw.sample.ft;</div><div class="line"></div><div class="line">    <span class="comment">// clear the canvas.</span></div><div class="line">    ctx.fillStyle = <span class="string">'rgba(0, 0, 0, 1)'</span>;</div><div class="line">    ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, width, height);</div><div class="line">    </div><div class="line">    <span class="comment">// draw the visualization frame</span></div><div class="line">    drawBars(width, height, ft);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawBars</span>(<span class="params">w, h, ft</span>) </span>&#123;</div><div class="line">    <span class="keyword">const</span> length = ft.length;</div><div class="line">    <span class="keyword">const</span> width = w / length;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; ft.length; i++) &#123;</div><div class="line">        <span class="keyword">const</span> height = ft[i] * <span class="number">250</span>;</div><div class="line">        <span class="keyword">const</span> x = i * width;</div><div class="line">        <span class="keyword">const</span> y = h - height;</div><div class="line">        ctx.fillRect(x, y, width - <span class="number">2</span>, height);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    name: <span class="string">'Simple Example'</span>,</div><div class="line">    init,</div><div class="line">    tick</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>The code above will display a simple frequency spectrum of red bars. Let’s take a look at each of the basic parts:</p>
<h4 id="init-function"><a href="#init-function" class="headerlink" title="init() function"></a><code>init()</code> function</h4><p>Every visualization <em>must</em> export an <code>init()</code> function. This function will be called once each time the visualization is selected in SKQW. It is used to set up the canvas as well as any other set-up your code may require. In this case we have SKQW create a new canvas for us to drawto, and save a reference to the canvas’ <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D" target="_blank" rel="external">context object</a>. Then we set the fillStyle property, since we don’t plan to change it in this simple example.</p>
<h4 id="skqw-object"><a href="#skqw-object" class="headerlink" title="skqw object"></a><code>skqw</code> object</h4><p>This object is passed as the first parameter to each of the visualization lifecycle functions. It has a single method, <code>createCanvas()</code>, which<br>will create an HTML canvas element which we can then draw on to.</p>
<p>It additionally has two properties: </p>
<ul>
<li><code>dimensions</code> which is an object containing the <code>width</code> and <code>height</code> of the<br>canvas; </li>
<li><code>sample</code> which is and object containing 2 arrays of numbers: <ul>
<li><code>ts</code> is the “time series” or waveform of the current audio sample.</li>
<li><code>ft</code> is the “fourier transform” or frequency spectrum of the current<br>audio sample.</li>
</ul>
</li>
</ul>
<p>The two arrays provided by <code>sample</code> provide the raw information that you will use to form the basis of your visualizations.</p>
<h4 id="tick-function"><a href="#tick-function" class="headerlink" title="tick() function"></a><code>tick()</code> function</h4><p>This is a required function which will be called every time a new audio sample arrives from the sound card, roughly 60 times per second. This is<br>where the magic happens! The <code>tick</code> function is responsible for rendering each individual frame of your visualization.</p>
<p>In our example, we first clear the canvas by drawing a big black rectangle over whatever was there before, and then we call a function which will<br>iterate over each value in the <code>sample.ft</code> array, and represent it as a red bar whose height is proportional to the value of that frequency.</p>
<h4 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a><code>module.exports</code></h4><p>Finally, we export the required information as a <a href="https://nodejs.org/docs/latest/api/modules.html" target="_blank" rel="external">Node commonjs</a> module. There are more functions and properties which SKQW can read (see the <a href="../api-reference">API docs</a>), which lets us write richer visualizations, but the three shown are the bare minimum required for things to work.</p>
<h2 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h2><p>It is possible to make certain aspects of a visualization configurable at run-time by the user. To do this we need to use parameters.</p>
<p>Here’s an example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> params = &#123;</div><div class="line">    hue: &#123;</div><div class="line">        value: <span class="number">120</span>,</div><div class="line">        type: <span class="string">'range'</span>,</div><div class="line">        label: <span class="string">'Hue'</span>,</div><div class="line">        min: <span class="number">0</span>,</div><div class="line">        max: <span class="number">360</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ... init() function omitted</span></div><div class="line"></div><div class="line">tick(skqw) &#123;</div><div class="line">    <span class="comment">// ... code omitted</span></div><div class="line">    ctx.fillStyle = <span class="string">`hsl(<span class="subst">$&#123;params.hue.value&#125;</span>, 50%, 50%)`</span>;</div><div class="line">    <span class="comment">// draw some stuff with the given hue.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">paramChange</span>(<span class="params">skqw, change</span>) </span>&#123;</div><div class="line">    params[change.paramKey].value = change.newValue;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    name: <span class="string">'Params Example'</span>,</div><div class="line">    init,</div><div class="line">    tick,</div><div class="line">    paramChange,</div><div class="line">    params</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Let’s walk through each of the new concepts introduced here:</p>
<h4 id="params-object"><a href="#params-object" class="headerlink" title="params object"></a><code>params</code> object</h4><p>The <code>params</code> object is where we define our user-configurable parameters. Each object will be represented by a UI control in the settings panel of the SKQW user interface. In this example, we want to enable the user to set the hue (colour) of some element in our visualization.</p>
<p>The <code>value</code>, <code>type</code>, and <code>label</code> properties are required:</p>
<ul>
<li><code>value</code> is the actual value of the parameter.</li>
<li><code>type</code> determines the type of UI control that will be rendered to<br>control this param. Currently only “range” and “boolean” are supported,<br>which will render a slider or a checkbox respectively.</li>
<li><code>label</code> is the label associated with the control in the UI. This is what<br>the user sees.</li>
</ul>
<p>Additionally, with a “range” type, we may also specify optional <code>min</code>,<br><code>max</code>, and <code>step</code> properties which control the behaviour of the slider<br>control.</p>
<h4 id="paramChange-function"><a href="#paramChange-function" class="headerlink" title="paramChange() function"></a><code>paramChange()</code> function</h4><p>This function is called every time the user changes the value of a param in the UI. The second argument is an object consisting of two properties:</p>
<ul>
<li><code>paramKey</code> is the key of the param that was changed. In this case it would be “hue”. </li>
<li><code>newValue</code> is the new value assigned by the user.</li>
</ul>
<p>Finally, we need to ensure we export <code>params</code> and <code>paramChange</code> so that SKQW knows about them.</p>
<h2 id="Next-Steps"><a href="#Next-Steps" class="headerlink" title="Next Steps"></a>Next Steps</h2><p>Now you should know enough to start playing around with SKQW visualizations and creating some cool visuals!</p>
<p>There are a few more parts of the API not covered above. For a full rundown of all APIs, see the <a href="../api-reference">API Reference</a>.</p>
<p>Another way to learn is to take a look at the <a href="https://github.com/michaelbromley/skqw-library" target="_blank" rel="external">source code of the standard library of visualizations</a>. </p>

  </div>
  <footer class="article-footer">

  </footer>
</article>


          <div class="main-footer">
    © 2016 Michael Bromley - Powered by <a href="http://hexo.io" target="_blank">Hexo</a>
</div>

      
        </div>
      
    </div>
  </div>
</body>
</html>
